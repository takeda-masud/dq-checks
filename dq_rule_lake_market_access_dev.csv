dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
800,duplicate_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select count(1) from (select LOGSYS,count(*) from corp_us_lake.generalledger_lineitems_takeda group by LOGSYS having count(*)>1);",P1,0,1
801,data_type,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select count(1) from corp_us_lake.generalledger_lineitems_takeda where (case when db_cr_ind is null then 'null' else case when (upper(db_cr_ind) REGEXP '^[A-Z]{1,1}$' and length(db_cr_ind)=1) then 'str' else 'number' end end in ('number','null') OR case when CREATEDON is null then 'null' else case when (CREATEDON REGEXP '^[0-9]{1,8}$' and length(CREATEDON)=8) then 'number' else 'string' end end in ('string','null') OR case when UPD_DATE is null then 'null' else case when (UPD_DATE REGEXP '^[0-9]{1,8}$' and length(UPD_DATE)=8) then 'number' else 'string' end end in ('string','null') OR case when VALUE_DATE is null then 'null' else case when (VALUE_DATE REGEXP '^[0-9]{1,8}$' and length(VALUE_DATE)=8) then 'number' else 'string' end end in ('string','null') OR case when VATDATE is null then 'null' else case when (VATDATE REGEXP '^[0-9]{1,8}$' and length(VATDATE)=8) then 'number' else 'string' end end in ('string','null') OR case when PSTNG_DATE is null then 'null' else case when (PSTNG_DATE REGEXP '^[0-9]{1,8}$' and length(PSTNG_DATE)=8) then 'number' else 'string' end end in ('string','null') OR case when DOC_DATE is null then 'null' else case when (DOC_DATE REGEXP '^[0-9]{1,8}$' and length(DOC_DATE)=8) then 'number' else 'string' end end in ('string','null') OR case when CLEAR_DATE is null then 'null' else case when (CLEAR_DATE REGEXP '^[0-9]{1,8}$' and length(CLEAR_DATE)=8) then 'number' else 'string' end end in ('string','null') OR case when FISCYEAR is null then 'null' else case when (FISCYEAR REGEXP '^[0-9]{1,4}$' and length(FISCYEAR)=4) then 'number' else 'string' end end in ('string','null') OR case when ACCT_TYPE is null then 'null' else case when (upper(ACCT_TYPE) REGEXP '^[A-Z]{1,1}$' and length(ACCT_TYPE)=1) then 'string' else 'number' end end in ('number','null') OR instr(bktxt,'|')>0 );",P1,0,2
final_check,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","Select case when metric > threshold then 1 else 0 end as res from dq_output_table where entity_id in (800,801)",P1,0,3
