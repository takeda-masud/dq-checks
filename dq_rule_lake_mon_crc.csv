dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
dq_2311,unit_count,com_us_lake,dagg_cdit_redist,row_id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt, 'Unit' as field_name from com_us_lake.dagg_cdit_redist sa join com_us_lake.man_lov lv on sa.product_name = lv.lov_code where to_date(sa.gl_date,'M/d/y') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(LOV_DESCRIPTION)='HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 2311) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,101
dq_2312,unit_count,com_us_lake,cnp_bd_cbk_sls,row_id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt, 'Unit' as field_name from com_us_lake.cnp_bd_cbk_sls sa join com_us_lake.man_lov lv on sa.product_name = lv.lov_code where to_date(sa.gl_date,'M/d/y') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(LOV_DESCRIPTION)='HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 2312) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,102
dq_2313,unit_count,com_us_lake,bpri_salesordertransactions,doc_number,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt,  'Unit' as field_name from com_us_lake.BPRI_BillingExtract bill JOIN com_us_lake.bpri_salesordertransactions sal ON (regexp_replace(sal.doc_number, '^0+(?!$)', '') = regexp_replace(bill.Sales_document,'^0+(?!$)', '') AND regexp_replace(sal.s_ord_item, '^0+(?!$)', '') = regexp_replace(bill.Sales_doc_Item, '^0+(?!$)','')) INNER JOIN com_us_lake.bpri_materialmasterdata mat ON (sal.material=mat.material) join com_us_lake.man_lov lv on regexp_replace(mat.material, '^0+(?!$)', '') = lv.lov_code where to_date(Billing_doc__date,'M/d/y') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(LOV_DESCRIPTION)='HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 2313) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,103
unit_final_check,unit_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_2311','dq_2312','dq_2313')",P1,0,104
