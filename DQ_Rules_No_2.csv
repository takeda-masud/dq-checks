dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
productcount,scd_count,com_us_lake,prd_pms_mstr,shireprodid,"with tmp as (select abs((cur_cnt-prv_cnt)/prv_cnt*100) as metric from ((select count(product) cur_cnt, 1 as id from com_us_lake.prd_pms_mstr where to_date(aud_upd_dts) = current_date) cur cross join (select count as prv_cnt, 1 as id from com_us_lake.dq_count_table where table_name = 'com_us_lake.prd_pms_mstr') prv on cur.id=prv.id)) select * from tmp",P1,10,1
final_check,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",Select case when metric > threshold then 1 else 0 end as res from dq_output_table where entity_id in (productcount),P1,0,2
