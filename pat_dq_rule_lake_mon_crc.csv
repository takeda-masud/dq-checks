dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
dq_3111,unit_count,com_us_lake,dagg_bax_comp,id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt, 'Unit' as field_name from (select * from com_us_lake.dagg_bax_comp cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_10digit union select * from com_us_lake.dagg_bax_comp cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_11digit) pa where to_date(ship_date,'yyyyMMdd') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(level_1_sales_force) = 'HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 3111) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,101
dq_3112,unit_count,com_us_lake,dagg_bax_dispense_file,id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt, 'Unit' as field_name from (select * from com_us_lake.dagg_bax_dispense_file cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_10digit union select * from com_us_lake.dagg_bax_dispense_file cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_11digit) pa where to_date(ship_date,'yyyyMMdd') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(level_1_sales_force) = 'HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 3112) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,102
unit_final_check,unit_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_3111','dq_3112')",P1,0,103
dq_3711,patient_count,com_us_lake,dagg_bax_comp,id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(distinct LH_PATIENT_ID) as cur_cnt, 'LH_Patient' as field_name from (select * from com_us_lake.dagg_bax_comp cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_10digit union select * from com_us_lake.dagg_bax_comp cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_11digit) pa where to_date(ship_date,'yyyyMMdd') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(level_1_sales_force) = 'HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 3711) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,104
dq_3712,patient_count,com_us_lake,dagg_bax_dispense_file,id,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(distinct LH_PAT_ID) as cur_cnt, 'LH_Patient' as field_name from (select * from com_us_lake.dagg_bax_dispense_file cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_10digit union select * from com_us_lake.dagg_bax_dispense_file cmp join com_us_lake.udef_ndc_hier ndc on cmp.ndc_number = ndc.ndc_code_11digit) pa where to_date(ship_date,'yyyyMMdd') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(level_1_sales_force) = 'HEMATOLOGY') cur cross join (select prv_count as prv_cnt, metric, field_name from com_us_lake.dq_count_table where rule_key = 3712) prv on cur.field_name=prv.field_name) select * from tmp",P1,20,105
patient_final_check,patient_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_3711','dq_3712')",P1,0,106
