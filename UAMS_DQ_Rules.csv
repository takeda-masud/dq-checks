dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
100,scd_duplicate,corp_us_hub,ref_vendmstrcocode_erp_glbl,"vendor_num, co_cd,src_system","with tmp as (select vendor_num, co_cd,src_system, scd_ver_num from corp_us_hub.ref_vendmstrcocode_erp_glbl where co_cd <> ''group by vendor_num, co_cd,src_system, scd_ver_num having count(1)>1) select count(1) from tmp",P1,0,1
101,scd_duplicate,corp_us_hub,ref_vendmstrpurchasingorgdata_erp_glbl,"vendor_num, co_cd,src_system","with tmp as (select vendor_num, src_system,purchasing_org,scd_ver_num from corp_us_hub.ref_vendmstrpurchasingorgdata_erp_glbl where purchasing_org<>'' group by vendor_num, src_system,purchasing_org,scd_ver_num having count(1)>1)select count(1) from tmp",P1,0,2
102,scd_count,com_us_lake,prd_pms_mstr,"shireprodid","with tmp as (select abs((cur_cnt-prv_cnt)/prv_cnt*100) from ((select count(product) cur_cnt, 1 as id from com_us_lake.prd_pms_mstr where to_date(aud_upd_dts) = '2022-02-14') cur inner join (select count(product) prv_cnt, 1 as id from com_us_lake.prd_pms_mstr where to_date(aud_load_dts) = '2020-09-26') prv on cur.id=prv.id)) select * from tmp",P1,10,3
final_check,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","Select case when metric > threshold then 1 else 0 end as res from dq_output_table where entity_id in (100,101,102)",P1,0,4
