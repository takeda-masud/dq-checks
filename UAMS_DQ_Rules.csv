dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
vendmstrcocode,scd_duplicate,corp_us_hub,ref_vendmstrcocode_erp_glbl,"vendor_num, co_cd,src_system","with tmp as (select vendor_num, co_cd,src_system, scd_ver_num from corp_us_hub.ref_vendmstrcocode_erp_glbl where co_cd <> ''group by vendor_num, co_cd,src_system, scd_ver_num having count(1)>1) select count(1) from tmp",P1,0,1
vendmstrpurchasingorgdata,scd_duplicate,corp_us_hub,ref_vendmstrpurchasingorgdata_erp_glbl,"vendor_num, co_cd,src_system","with tmp as (select vendor_num, src_system,purchasing_org,scd_ver_num from corp_us_hub.ref_vendmstrpurchasingorgdata_erp_glbl where purchasing_org<>'' group by vendor_num, src_system,purchasing_org,scd_ver_num having count(1)>1)select count(1) from tmp",P1,0,2
custmstrcreditmgmnt,scd_duplicate,corp_us_hub,ref_custmstrcreditmgmnt_erp_glbl,"cust_num,credit_ctrl_area,src_system","with tmp as (select cust_num,credit_ctrl_area,src_system,scd_ver_num from corp_us_hub.ref_custmstrcreditmgmnt_erp_glbl where credit_ctrl_area<>'' group by cust_num,credit_ctrl_area,src_system,scd_ver_num having count(1)>1) select count(1) from tmp",P1,0,3
custmstrcocodeinfo,scd_duplicate,corp_us_hub,ref_custmstrcocodeinfo_erp_glbl,"cust_num, co_cd,src_system","with tmp as(select cust_num, co_cd,src_system,scd_ver_num from corp_us_hub.ref_custmstrcocodeinfo_erp_glbl where co_cd<>'' group by cust_num, co_cd,src_system,scd_ver_num having count(1)>1) select count(1) from tmp",P1,0,4
generalledgerlineitems,duplicate,corp_us_hub,txn_generalledgerlineitems_erp_glbl,"LOGSYS,COMP_CD,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","with tmp as (select LOGSYS,COMP_CD,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM,count(*) from corp_us_hub.txn_generalledgerlineitems_erp_glbl group by LOGSYS,COMP_CD,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM having count(*)>1)select count(1) from tmp",P1,0,5
generalledgerlineitems,data_issue,corp_us_hub,txn_generalledgerlineitems_erp_glbl,"LOGSYS,COMP_CD,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","with tmp as (select * from corp_us_hub.txn_generalledgerlineitems_erp_glbl where (case when db_cr_ind='' then 'null' else case when (upper(db_cr_ind) REGEXP '^[A-Z]{1,1}$' and length(db_cr_ind)=1) then 'str' else 'number' end end in ('number','null') OR case when CREATEDON is null then 'null' else case when (CREATEDON REGEXP '^[0-9]{1,8}$' and length(CREATEDON)=8) then 'number' else 'string' end end in ('string','null') OR case when UPD_DT is null then 'null' else case when (VALUE_DT REGEXP '^[0-9]{1,8}$' and length(VALUE_DT)=8) then 'number' else 'string' end end in ('string','null') OR case when VALUE_DT is null then 'null' else case when (VALUE_DT REGEXP '^[0-9]{1,8}$' and length(VALUE_DT)=8) then 'number' else 'string' end end in ('string','null') OR case when VATDT is null then 'null' else case when (VATDT REGEXP '^[0-9]{1,8}$' and length(VATDT)=8) then 'number' else 'string' end end in ('string','null') OR case when PSTNG_DT is null then 'null' else case when (PSTNG_DT REGEXP '^[0-9]{1,8}$' and length(PSTNG_DT)=8) then 'number' else 'string' end end in ('string','null') OR case when DOC_DT is null then 'null' else case when (DOC_DT REGEXP '^[0-9]{1,8}$' and length(DOC_DT)=8) then 'number' else 'string' end end in ('string','null') OR case when CLEAR_DT is null then 'null' else case when (CLEAR_DT REGEXP '^[0-9]{1,8}$' and length(CLEAR_DT)=8) then 'number' else 'string' end end in ('string','null') OR case when FISCYR is null then 'null' else case when (FISCYR REGEXP '^[0-9]{1,4}$' and length(FISCYR)=4) then 'number' else 'string' end end in ('string','null') OR case when ACCT_TYP is null then 'null' else case when (upper(ACCT_TYP) REGEXP '^[A-Z]{1,1}$' and length(ACCT_TYP)=1) then 'string' else 'number' end end in ('number','null') OR instr(bktxt,'|')>0 ))select count(distinct md5_key) from tmp",P1,0,6
productcount,scd_count,com_us_lake,prd_pms_mstr,"shireprodid","with tmp as (select (cur_cnt-prv_cnt)/prv_cnt*100 from ((select count(product) cur_cnt, 1 as id from com_us_lake.prd_pms_mstr where to_date(aud_upd_dts) = '2021-01-15') cur inner join (select count(product) prv_cnt, 1 as id from com_us_lake.prd_pms_mstr where to_date(aud_load_dts) = '2020-09-26') prv on cur.id=prv.id) select * from tmp",P1,10,7
