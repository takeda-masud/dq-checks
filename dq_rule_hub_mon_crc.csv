dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
dq_2321,unit_count,com_us_hub,txn_redist_sls,redist_sls_key,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from (select count(1) as cur_cnt, 'Unit' as field_name from com_us_hub.txn_redist_sls sa where to_date(sa.gl_date,'M/d/y') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(sa.franchise_nm) IN ('HEMATOLOGY','IMMUNOLOGY')) cur cross join (select metric, field_name from com_us_lake.dq_count_table where rule_key = 2321) prv on cur.field_name = prv.field_name) select * from tmp",P1,20,101
dq_2322,unit_count,com_us_hub,txn_dir_sls,sls_key,"with tmp (select abs((cur_cnt-metric)/metric*100) as metric from ((select count(1) as cur_cnt, 'Unit' as field_name from com_us_hub.txn_dir_sls sa where to_date(sa.gl_date,'M/d/y') between trunc(current_date, 'mm') and date_add(trunc(add_months(current_date, 1), 'mm'), -1) and upper(sa.franchise_nm) IN ('HEMATOLOGY','IMMUNOLOGY')) cur cross join (select  metric, field_name from com_us_lake.dq_count_table where rule_key = 2322) prv on cur.field_name = prv.field_name)) select * from tmp",P1,20,102
final_check,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM","select case when metric > threshold then 1 else 0 end as res from dq_output_table where entity_id in ('dq_2321','dq_2322')",P1,0,103
