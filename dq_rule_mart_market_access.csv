dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
dq_20131,Blank_prod_id,com_us_mart_03,txn_dir_redist_sls,dir_redist_sls_key,with tmp ( select count(*) as cur_cnt from  com_us_mart_03.txn_dir_redist_sls      where  chnl_typ  ='SPP'  and   prod_id is null)  select * from tmp,P1,0,1
prod_id_blank_final_check,unit_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20131'),P1,0,2
dq_20231,Blank_Reporting_group,com_us_mart_03,txn_dir_redist_sls,dir_redist_sls_key,with tmp ( select count(*) as cur_cnt from  com_us_mart_03.txn_dir_redist_sls      where  chnl_typ  ='SPP'  and   ndc_reporting_group_nm is null)  select * from tmp,P1,0,3
Reporting_group_Balank_final_check,Blank_Reporting_group,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20231'),P1,0,4
dq_20331,Blank_End_cust_nm,com_us_mart_03,ref_affiliated_account,dir_redist_sls_key,with tmp  (select  count(pr.End_cust_nm) as product from com_us_mart_03.txn_dir_redist_sls sa join com_us_mart_03.ref_affiliated_account pr on sa.end_cust_mstr_id = pr.end_cust_id  where  chnl_typ  ='SPP'  and   pr.End_cust_nm is null)  select * from tmp,P1,0,5
Blank_End_cust_nm_final_check,End_cust_nmr_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20331'),P1,0,6
dq_20431,Blank_prod_desc,com_us_mart_03,ref_affiliated_account,dir_redist_sls_key,with tmp ( select count(*) as cur_cnt from  com_us_mart_03.txn_dir_redist_sls a left join  com_us_mart_03.ref_prd_prod  b on  a.prod_key=b.prd_prod_key   where  chnl_typ  ='SPP'  and   b.prod_nm is null)  select * from tmp,P1,0,7
Blank_prod_desc_final_check,customer_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20431'),P1,0,8
dq_20531,Blank_chnl_nm,com_us_mart_03,ref_affiliated_account,dir_redist_sls_key,with tmp ( select count(*) as cur_cnt from  com_us_mart_03.txn_dir_redist_sls      where  chnl_typ  ='SPP'  and   chnl_nm is null)  select * from tmp,P1,0,9
chnl_nm_blank_final_check,chnl_nm_blank,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20531'),P1,0,10
dq_20631,Blank_contract_id,com_us_mart_03,ref_affiliated_account,dir_redist_sls_key,with tmp ( select count(1) as cur_cnt from  com_us_mart_03.ref_cntrct_prcing  a left join   com_us_mart_03.txn_dir_redist_sls b  on a.cntrct_prcing_key= b.pricing_contract_key     where  chnl_typ  ='SPP'  and   a.contract_id is null)  select * from tmp,P1,0,11
Blank_contract_id_final_check,contract_id_count,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",select case when metric > threshold then 1 else 0 end as res from corp_us_lake.dq_output_table where entity_id in ('dq_20631'),P1,0,12
dq_20131,Dates_missing,com_us_mart_03,txn_dir_redist_sls,dir_redist_sls_key,"with tmp (
select (select   count(distinct actual_date)  from com_us_hub.ref_cal 
where   ( actual_date between  (to_Date(add_months(trunc(current_date, 'MM') , -48),'MM/DD/YYYY')) and  date_add(to_Date(trunc(current_date, 'MM') ,'MM/DD/YYYY'),-1)) and dayofweek(actual_date)  not in(1,7) )-
(select  count(distinct gl_date) from com_us_mart_03.txn_dir_redist_sls
where   ( gl_date between  (to_Date(add_months(trunc(current_date, 'MM') , -48),'MM/DD/YYYY')) and  date_add(to_Date(trunc(current_date, 'MM') ,'MM/DD/YYYY'),-1)) and dayofweek(gl_date)  not  in(1,7) )
)
select * from  tmp ",P1,0,13
final_check From_Date and To_Date ,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM",Select case when metric > threshold then 1 else 0 end as res from dq_output_table where entity_id in (dq_20131),P1,0,14
