dq_check_id,Check,Database_name,table_name,primary_key_cols,sql_fr_run,priority,threshold,run_seq
301,product_count,com_us_mart_03,txn_patient_dispense,prod_key," with tmp (select max(abs((cur_cnt-prv_cnt)/metric*100)) as metric from ((select count(1) as cur_cnt,pr.chnl_nm as product from com_us_mart_03.txn_dir_redist_sls sa join com_us_mart_03.txn_patient_dispense pr on sa.prod_key = pr.prod_key where sa.gl_date between (select min(period_start_date) from com_us_lake.dq_count_table where dq_rule = 'dq_rule_4' and table_name = 'com_us_mart_03.txn_patient_dispense')  and (select max(period_end_date) from com_us_lake.dq_count_table where dq_rule = 'dq_rule_4' and table_name = 'txn_dir_redist_sls-txn_patient_dispense') group by pr.chnl_nm) cur cross join (select prv_count as prv_cnt,metric, sub_field_name
 as product from com_us_lake.dq_count_table where dq_rule = 'dq_rule_4' and table_name = 'txn_dir_redist_sls-txn_patient_dispense') prv on cur.product=prv.product)) select * from tmp",P1,10,1
final_check,final_check,corp_us_lake,generalledger_lineitems_takeda,"LOGSYS,COMP_CODE,CHRT_ACCTS,GL_ACCOUNT,FISCVARNT,FISCPER,AC_DOC_NO,ITEM_NUM", as product from com_us_lake.dq_count_table where dq_rule = 'dq_rule_4' and table_name = 'txn_dir_redist_sls-txn_patient_dispense') prv on cur.product=prv.product)) select * from tmp,P1,0,2
